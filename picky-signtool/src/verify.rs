use std::fs::OpenOptions;
use std::io::Read;
use std::path::{Path, PathBuf};

use anyhow::{anyhow, bail, Context};
use clap::ArgMatches;
use lief::Binary;

use picky::hash::HashAlgorithm;
use picky::x509::date::UTCDate;
use picky::x509::pkcs7::authenticode::{AuthenticodeSignature, AuthenticodeValidator, ShaVariant};
use picky::x509::pkcs7::ctl::http_fetch::CtlHttpFetch;
use picky::x509::pkcs7::ctl::CertificateTrustList;
use picky::x509::wincert::WinCertificate;

use crate::config::{
    ARG_BINARY, ARG_PS_SCRIPT, ARG_VERIFY, ARG_VERIFY_BASIC, ARG_VERIFY_CA, ARG_VERIFY_CHAIN,
    ARG_VERIFY_SIGNING_CERTIFICATE, PS_AUTHENTICODE_FOOTER, PS_AUTHENTICODE_HEADER, PS_AUTHENTICODE_LINES_SPLITTER,
};
use crate::get_utf8_file_name;
use crate::sign::{compute_ps_file_checksum_from_content, UTF16_BE_BOM, UTF16_LE_BOM};
use crate::utils::str_to_utf16_bytes;

pub fn verify(matches: &ArgMatches, files: &[PathBuf]) -> anyhow::Result<()> {
    let mut at_least_one_error = false;

    let flags = matches
        .values_of(ARG_VERIFY)
        .unwrap()
        .map(ToString::to_string)
        .collect::<Vec<String>>();

    let authenticode_signatures = match (matches.is_present(ARG_BINARY), matches.is_present(ARG_PS_SCRIPT)) {
        (true, false) => {
            let binary_path = files[0].clone();
            let binary =
                Binary::new(binary_path.clone()).map_err(|err| anyhow!("Failed to load the executable: {}", err))?;

            let authenticode_signature = extract_authenticode_signature_from_binary(&binary)?;
            let binary_name = get_utf8_file_name(&binary_path)?;
            let file_hash = binary
                .get_file_hash_sha256()
                .map_err(|err| anyhow!("Failed to compute file hash for target binary: {}", err.to_string()))?;

            vec![(authenticode_signature, binary_name.to_owned(), file_hash)]
        }
        (false, true) => {
            let mut authenticode_signatures = Vec::with_capacity(files.len());

            for file_path in files {
                let extract_signature = |file_path: &Path| -> anyhow::Result<(AuthenticodeSignature, String, Vec<u8>)> {
                    let authenticode_signature = match authenticode_signature_ps_from_file(file_path) {
                        Ok(authenticode_signature) => authenticode_signature,
                        Err(err) => bail!("{} -> {}\n", err.to_string(), err.root_cause()),
                    };

                    let algorithm_identifier_oid = authenticode_signature
                        .0
                        .digest_algorithms()
                        .first()
                        .expect("AlgorithmIdentifier should be present")
                        .oid_asn1()
                        .clone();

                    let sha_variant = ShaVariant::try_from(algorithm_identifier_oid)
                        .with_context(|| format!("Failed compute checksum for {:?}", file_path))?;

                    let hash = HashAlgorithm::try_from(sha_variant)
                        .with_context(|| format!("Failed compute checksum for {:?}", file_path))?;

                    let ps_file_name = get_utf8_file_name(file_path)?;

                    let file_hash = compute_ps_file_checksum_from_content(file_path, hash)
                        .with_context(|| format!("Failed to compute {:?} checksum for {:?}", hash, file_path))?;

                    Ok((authenticode_signature, ps_file_name.to_owned(), file_hash))
                };

                match extract_signature(file_path) {
                    Ok(extracted) => authenticode_signatures.push(extracted),
                    Err(e) => {
                        at_least_one_error = true;
                        eprintln!("{:?}", e);
                    }
                }
            }
            authenticode_signatures
        }
        (true, true) => {
            bail!("Do not know what to verify exactly(`binary` and `script` both are specified)")
        }
        (false, false) => {
            bail!("Do not know what to verify(`binary` or `script` is not specified)")
        }
    };

    let flags = flags
        .iter()
        .filter(|flag| match flag.as_str() {
            ARG_VERIFY_BASIC | ARG_VERIFY_SIGNING_CERTIFICATE | ARG_VERIFY_CHAIN | ARG_VERIFY_CA => true,
            other => {
                eprintln!("Skipping unknown flag `{}`", other);
                false
            }
        })
        .cloned()
        .collect::<Vec<String>>();

    let ctl = if flags.iter().any(|flag| flag.as_str() == ARG_VERIFY_CHAIN) {
        let ctl = CertificateTrustList::fetch()?;
        Some(ctl)
    } else {
        None
    };

    for (authenticode_signature, file_name, file_hash) in authenticode_signatures {
        let validator = authenticode_signature.authenticode_verifier();

        let now = UTCDate::now();
        let validator = apply_flags(&validator, &flags, &now, file_hash, ctl.as_ref());

        match validator.verify() {
            Ok(()) => println!("{} has valid digital signature", file_name),
            Err(err) => {
                eprintln!("{} has invalid digital signature: {}", file_name, err.to_string());
                at_least_one_error = true;
            }
        }
    }

    if at_least_one_error {
        bail!("Terminated with error(s)");
    }

    Ok(())
}

fn extract_authenticode_signature_from_binary(binary: &Binary) -> anyhow::Result<AuthenticodeSignature> {
    let authenticode_data = binary
        .get_authenticode_data()
        .map_err(|err| anyhow!("Failed to extract Authenticode signature from target binary: {}", err))?;

    let wincert = WinCertificate::decode(&authenticode_data)
        .map_err(|err| anyhow!("Failed to decode authenticode data: {}", err))?;

    let authenticode_signature = AuthenticodeSignature::from_der(wincert.get_certificate())
        .context("Failed to deserialize Authenticode signature")?;

    Ok(authenticode_signature)
}

pub fn authenticode_signature_ps_from_file(file_path: &Path) -> anyhow::Result<AuthenticodeSignature> {
    let mut file = OpenOptions::new()
        .read(true)
        .open(file_path)
        .with_context(|| format!("Failed to open {:?} for reading", file_path))?;

    let mut buffer = Vec::new();
    file.read_to_end(&mut buffer).unwrap();

    // invalid characters will be replaced with ï¿½ (replacement character)
    let (buffer, ..) = if buffer.starts_with(&UTF16_LE_BOM) {
        encoding_rs::UTF_16LE.decode(&buffer)
    } else if buffer.starts_with(&UTF16_BE_BOM) {
        encoding_rs::UTF_16BE.decode(&buffer)
    } else {
        encoding_rs::UTF_8.decode(&buffer)
    };

    let signature = extract_ps_authenticode_signature(buffer.to_string())
        .with_context(|| format!("Failed to extract Authenticode signature from {:?}", file_path))?;

    let der_signature = base64::decode(signature).context("Failed to convert signature to DER")?;

    let authenticode_signature = AuthenticodeSignature::from_der(&der_signature)
        .with_context(|| format!("Failed to deserialize Authenticode signature for {:?}", file_path))?;

    Ok(authenticode_signature)
}

fn extract_ps_authenticode_signature(content: String) -> anyhow::Result<String> {
    let index = content
        .find(PS_AUTHENTICODE_HEADER)
        .ok_or_else(|| anyhow!("File is not digital signed"))?;

    let (_, signature) = content.split_at(index);
    let mut out = String::new();
    for line in signature.lines() {
        if line.contains(PS_AUTHENTICODE_HEADER) || line.contains(PS_AUTHENTICODE_FOOTER) {
            continue;
        }

        if line.contains(PS_AUTHENTICODE_LINES_SPLITTER) {
            out.push_str(line.replace(PS_AUTHENTICODE_LINES_SPLITTER, "").trim_end_matches('\r'));
        }
    }

    Ok(out)
}

fn apply_flags<'a>(
    validator: &'a AuthenticodeValidator<'a>,
    flags: &[String],
    time: &'a UTCDate,
    file_hash: Vec<u8>,
    ctl: Option<&'a CertificateTrustList>,
) -> &'a AuthenticodeValidator<'a> {
    let validator = validator
        .ignore_basic_authenticode_validation()
        .ignore_signing_certificate_check()
        .ignore_chain_check()
        .ignore_ca_against_ctl_check()
        .ignore_not_before_check()
        .ignore_not_after_check()
        .ignore_excluded_cert_authorities();

    let validator = if flags.iter().any(|flag| flag.as_str() == ARG_VERIFY_BASIC) {
        validator.require_basic_authenticode_validation(file_hash)
    } else {
        &validator
    };

    let validator = if flags.iter().any(|flag| flag.as_str() == ARG_VERIFY_SIGNING_CERTIFICATE) {
        validator
            .require_signing_certificate_check()
            .require_not_after_check()
            .require_not_before_check()
            .require_chain_check()
            .exact_date(time)
    } else {
        &validator
    };

    let validator = if flags.iter().any(|flag| flag.as_str() == ARG_VERIFY_CHAIN) {
        let validator = validator.require_chain_check();
        if let Some(ctl) = ctl {
            validator.ctl(ctl)
        } else {
            validator
        }
    } else {
        &validator
    };

    if flags.iter().any(|flag| flag.as_str() == ARG_VERIFY_CA) {
        validator.require_ca_against_ctl_check()
    } else {
        validator
    }
}

pub fn extract_signed_ps_file_content_bytes(raw_content: &[u8]) -> &[u8] {
    // raw_content - utf-16 encoded bytes
    let find = |haystack: &[u8], needle: &Vec<u8>| -> Option<usize> {
        if haystack.len() < needle.len() {
            return None;
        }
        for i in 0..(haystack.len() - needle.len() + 1) {
            if haystack[i..(i + needle.len())] == needle[..] {
                return Some(i);
            }
        }
        None
    };

    let mut ps_authenticode_header = Vec::with_capacity(PS_AUTHENTICODE_HEADER.len() * 2);
    str_to_utf16_bytes(PS_AUTHENTICODE_HEADER, &mut ps_authenticode_header);

    let end = match find(raw_content, &ps_authenticode_header) {
        Some(index) => index - 4, // -4 to remove \r\n from the `# SIG # Begin signature block` line
        None => return raw_content,
    };

    &raw_content[0..end]
}

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn try_to_extract_ps_authenticode_signature() {
        let ps_authenticode_signature = "                     # SIG # Begin signature block\r\n# MIIFjAYJKoZIhvcNAQcCoIIFfTCCBXkCAQExDzANBglghkgBZQMEAgEFADB5Bgor\r\n# BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG\r\n# SIG # End signature block\r\n";

        let ps_authenticode_signature =
            extract_ps_authenticode_signature(ps_authenticode_signature.to_string()).unwrap();
        assert_eq!(ps_authenticode_signature.as_str(), "MIIFjAYJKoZIhvcNAQcCoIIFfTCCBXkCAQExDzANBglghkgBZQMEAgEFADB5BgorBgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG");
    }

    #[test]
    fn test_extract_signed_ps_file_content_bytes() {
        let signed_utf16_file = [
            0xFF, 0xFE, 0x23, 0x00, 0x20, 0x00, 0x53, 0x00, 0x63, 0x00, 0x72, 0x00, 0x69, 0x00, 0x70, 0x00, 0x74, 0x00,
            0x20, 0x00, 0x6D, 0x00, 0x6F, 0x00, 0x64, 0x00, 0x75, 0x00, 0x6C, 0x00, 0x65, 0x00, 0x20, 0x00, 0x6F, 0x00,
            0x72, 0x00, 0x20, 0x00, 0x62, 0x00, 0x69, 0x00, 0x6E, 0x00, 0x61, 0x00, 0x72, 0x00, 0x79, 0x00, 0x20, 0x00,
            0x6D, 0x00, 0x6F, 0x00, 0x64, 0x00, 0x75, 0x00, 0x6C, 0x00, 0x65, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x0D, 0x00,
            0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x53, 0x00, 0x49, 0x00, 0x47, 0x00, 0x20, 0x00, 0x23, 0x00, 0x20, 0x00,
            0x42, 0x00, 0x65, 0x00, 0x67, 0x00, 0x69, 0x00, 0x6E, 0x00, 0x20, 0x00, 0x73, 0x00, 0x69, 0x00, 0x67, 0x00,
            0x6E, 0x00, 0x61, 0x00, 0x74, 0x00, 0x75, 0x00, 0x72, 0x00, 0x65, 0x00, 0x20, 0x00, 0x62, 0x00, 0x6C, 0x00,
            0x6F, 0x00, 0x63, 0x00, 0x6B, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x4D, 0x00, 0x49, 0x00,
            0x49, 0x00, 0x47, 0x00, 0x47, 0x00, 0x77, 0x00, 0x59, 0x00, 0x4A, 0x00, 0x4B, 0x00, 0x6F, 0x00, 0x5A, 0x00,
            0x49, 0x00, 0x68, 0x00, 0x76, 0x00, 0x63, 0x00, 0x4E, 0x00, 0x41, 0x00, 0x51, 0x00, 0x63, 0x00, 0x43, 0x00,
            0x6F, 0x00, 0x49, 0x00, 0x49, 0x00, 0x47, 0x00, 0x44, 0x00, 0x44, 0x00, 0x43, 0x00, 0x43, 0x00, 0x42, 0x00,
            0x67, 0x00, 0x67, 0x00, 0x43, 0x00, 0x41, 0x00, 0x51, 0x00, 0x45, 0x00, 0x78, 0x00, 0x44, 0x00, 0x7A, 0x00,
            0x41, 0x00, 0x4E, 0x00, 0x42, 0x00, 0x67, 0x00, 0x6C, 0x00, 0x67, 0x00, 0x68, 0x00, 0x6B, 0x00, 0x67, 0x00,
            0x42, 0x00, 0x5A, 0x00, 0x51, 0x00, 0x4D, 0x00, 0x45, 0x00, 0x41, 0x00, 0x67, 0x00, 0x45, 0x00, 0x46, 0x00,
            0x41, 0x00, 0x44, 0x00, 0x42, 0x00, 0x35, 0x00, 0x42, 0x00, 0x67, 0x00, 0x6F, 0x00, 0x72, 0x00, 0x0D, 0x00,
            0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x42, 0x00, 0x67, 0x00, 0x45, 0x00, 0x45, 0x00, 0x41, 0x00, 0x59, 0x00,
            0x49, 0x00, 0x33, 0x00, 0x41, 0x00, 0x67, 0x00, 0x45, 0x00, 0x45, 0x00, 0x6F, 0x00, 0x47, 0x00, 0x73, 0x00,
            0x77, 0x00, 0x61, 0x00, 0x54, 0x00, 0x41, 0x00, 0x30, 0x00, 0x42, 0x00, 0x67, 0x00, 0x6F, 0x00, 0x72, 0x00,
            0x42, 0x00, 0x67, 0x00, 0x45, 0x00, 0x45, 0x00, 0x41, 0x00, 0x59, 0x00, 0x49, 0x00, 0x33, 0x00, 0x41, 0x00,
            0x67, 0x00, 0x45, 0x00, 0x65, 0x00, 0x4D, 0x00, 0x43, 0x00, 0x59, 0x00, 0x43, 0x00, 0x41, 0x00, 0x77, 0x00,
            0x45, 0x00, 0x41, 0x00, 0x41, 0x00, 0x41, 0x00, 0x51, 0x00, 0x51, 0x00, 0x48, 0x00, 0x38, 0x00, 0x77, 0x00,
            0x37, 0x00, 0x59, 0x00, 0x46, 0x00, 0x6C, 0x00, 0x4C, 0x00, 0x43, 0x00, 0x45, 0x00, 0x36, 0x00, 0x33, 0x00,
            0x4A, 0x00, 0x4E, 0x00, 0x4C, 0x00, 0x47, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x4B, 0x00,
            0x58, 0x00, 0x37, 0x00, 0x7A, 0x00, 0x55, 0x00, 0x51, 0x00, 0x49, 0x00, 0x42, 0x00, 0x41, 0x00, 0x41, 0x00,
            0x49, 0x00, 0x42, 0x00, 0x41, 0x00, 0x41, 0x00, 0x49, 0x00, 0x42, 0x00, 0x41, 0x00, 0x41, 0x00, 0x49, 0x00,
            0x42, 0x00, 0x41, 0x00, 0x41, 0x00, 0x49, 0x00, 0x42, 0x00, 0x41, 0x00, 0x44, 0x00, 0x41, 0x00, 0x78, 0x00,
            0x4D, 0x00, 0x41, 0x00, 0x30, 0x00, 0x47, 0x00, 0x43, 0x00, 0x57, 0x00, 0x43, 0x00, 0x47, 0x00, 0x53, 0x00,
            0x41, 0x00, 0x46, 0x00, 0x6C, 0x00, 0x41, 0x00, 0x77, 0x00, 0x51, 0x00, 0x43, 0x00, 0x41, 0x00, 0x51, 0x00,
            0x55, 0x00, 0x41, 0x00, 0x42, 0x00, 0x43, 0x00, 0x43, 0x00, 0x55, 0x00, 0x75, 0x00, 0x76, 0x00, 0x69, 0x00,
            0x61, 0x00, 0x67, 0x00, 0x35, 0x00, 0x62, 0x00, 0x70, 0x00, 0x6D, 0x00, 0x72, 0x00, 0x6A, 0x00, 0x52, 0x00,
            0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x67, 0x00, 0x35, 0x00, 0x65, 0x00, 0x63, 0x00, 0x36, 0x00,
            0x6B, 0x00, 0x78, 0x00, 0x53, 0x00, 0x6E, 0x00, 0x41, 0x00, 0x33, 0x00, 0x78, 0x00, 0x47, 0x00, 0x4E, 0x00,
            0x75, 0x00, 0x32, 0x00, 0x58, 0x00, 0x56, 0x00, 0x48, 0x00, 0x63, 0x00, 0x71, 0x00, 0x41, 0x00, 0x33, 0x00,
            0x46, 0x00, 0x37, 0x00, 0x35, 0x00, 0x72, 0x00, 0x55, 0x00, 0x39, 0x00, 0x71, 0x00, 0x43, 0x00, 0x43, 0x00,
            0x41, 0x00, 0x32, 0x00, 0x34, 0x00, 0x77, 0x00, 0x67, 0x00, 0x67, 0x00, 0x4E, 0x00, 0x71, 0x00, 0x4D, 0x00,
            0x49, 0x00, 0x49, 0x00, 0x43, 0x00, 0x55, 0x00, 0x71, 0x00, 0x41, 0x00, 0x44, 0x00, 0x41, 0x00, 0x67, 0x00,
            0x45, 0x00, 0x43, 0x00, 0x41, 0x00, 0x68, 0x00, 0x41, 0x00, 0x7A, 0x00, 0x41, 0x00, 0x75, 0x00, 0x41, 0x00,
            0x39, 0x00, 0x6F, 0x00, 0x4A, 0x00, 0x34, 0x00, 0x46, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00,
            0x6D, 0x00, 0x45, 0x00, 0x61, 0x00, 0x43, 0x00, 0x50, 0x00, 0x65, 0x00, 0x6F, 0x00, 0x6F, 0x00, 0x6A, 0x00,
            0x72, 0x00, 0x42, 0x00, 0x50, 0x00, 0x4D, 0x00, 0x41, 0x00, 0x30, 0x00, 0x47, 0x00, 0x43, 0x00, 0x53, 0x00,
            0x71, 0x00, 0x47, 0x00, 0x53, 0x00, 0x49, 0x00, 0x62, 0x00, 0x33, 0x00, 0x44, 0x00, 0x51, 0x00, 0x45, 0x00,
            0x42, 0x00, 0x43, 0x00, 0x77, 0x00, 0x55, 0x00, 0x41, 0x00, 0x4D, 0x00, 0x45, 0x00, 0x59, 0x00, 0x78, 0x00,
            0x43, 0x00, 0x7A, 0x00, 0x41, 0x00, 0x4A, 0x00, 0x42, 0x00, 0x67, 0x00, 0x4E, 0x00, 0x56, 0x00, 0x42, 0x00,
            0x41, 0x00, 0x59, 0x00, 0x54, 0x00, 0x41, 0x00, 0x6C, 0x00, 0x56, 0x00, 0x54, 0x00, 0x4D, 0x00, 0x52, 0x00,
            0x77, 0x00, 0x77, 0x00, 0x47, 0x00, 0x67, 0x00, 0x59, 0x00, 0x44, 0x00, 0x56, 0x00, 0x51, 0x00, 0x51, 0x00,
            0x4B, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x44, 0x00, 0x42, 0x00, 0x4E, 0x00, 0x44, 0x00,
            0x62, 0x00, 0x32, 0x00, 0x35, 0x00, 0x30, 0x00, 0x62, 0x00, 0x33, 0x00, 0x4E, 0x00, 0x76, 0x00, 0x49, 0x00,
            0x45, 0x00, 0x4E, 0x00, 0x76, 0x00, 0x63, 0x00, 0x6E, 0x00, 0x42, 0x00, 0x76, 0x00, 0x63, 0x00, 0x6D, 0x00,
            0x46, 0x00, 0x30, 0x00, 0x61, 0x00, 0x57, 0x00, 0x39, 0x00, 0x75, 0x00, 0x4D, 0x00, 0x52, 0x00, 0x6B, 0x00,
            0x77, 0x00, 0x46, 0x00, 0x77, 0x00, 0x59, 0x00, 0x44, 0x00, 0x56, 0x00, 0x51, 0x00, 0x51, 0x00, 0x44, 0x00,
            0x44, 0x00, 0x42, 0x00, 0x42, 0x00, 0x44, 0x00, 0x62, 0x00, 0x32, 0x00, 0x35, 0x00, 0x30, 0x00, 0x62, 0x00,
            0x33, 0x00, 0x4E, 0x00, 0x76, 0x00, 0x49, 0x00, 0x46, 0x00, 0x4E, 0x00, 0x76, 0x00, 0x5A, 0x00, 0x6E, 0x00,
            0x52, 0x00, 0x33, 0x00, 0x59, 0x00, 0x58, 0x00, 0x4A, 0x00, 0x6C, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00,
            0x20, 0x00, 0x4D, 0x00, 0x42, 0x00, 0x34, 0x00, 0x58, 0x00, 0x44, 0x00, 0x54, 0x00, 0x49, 0x00, 0x78, 0x00,
            0x4D, 0x00, 0x54, 0x00, 0x41, 0x00, 0x78, 0x00, 0x4F, 0x00, 0x54, 0x00, 0x45, 0x00, 0x34, 0x00, 0x4E, 0x00,
            0x54, 0x00, 0x6B, 0x00, 0x79, 0x00, 0x4D, 0x00, 0x31, 0x00, 0x6F, 0x00, 0x58, 0x00, 0x44, 0x00, 0x54, 0x00,
            0x49, 0x00, 0x79, 0x00, 0x4D, 0x00, 0x54, 0x00, 0x41, 0x00, 0x78, 0x00, 0x4F, 0x00, 0x54, 0x00, 0x45, 0x00,
            0x35, 0x00, 0x4D, 0x00, 0x54, 0x00, 0x6B, 0x00, 0x79, 0x00, 0x4D, 0x00, 0x31, 0x00, 0x6F, 0x00, 0x77, 0x00,
            0x52, 0x00, 0x6A, 0x00, 0x45, 0x00, 0x4C, 0x00, 0x4D, 0x00, 0x41, 0x00, 0x6B, 0x00, 0x47, 0x00, 0x41, 0x00,
            0x31, 0x00, 0x55, 0x00, 0x45, 0x00, 0x42, 0x00, 0x68, 0x00, 0x4D, 0x00, 0x43, 0x00, 0x56, 0x00, 0x56, 0x00,
            0x4D, 0x00, 0x78, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x48, 0x00, 0x44, 0x00, 0x41, 0x00,
            0x61, 0x00, 0x42, 0x00, 0x67, 0x00, 0x4E, 0x00, 0x56, 0x00, 0x42, 0x00, 0x41, 0x00, 0x6F, 0x00, 0x4D, 0x00,
            0x45, 0x00, 0x30, 0x00, 0x4E, 0x00, 0x76, 0x00, 0x62, 0x00, 0x6E, 0x00, 0x52, 0x00, 0x76, 0x00, 0x63, 0x00,
            0x32, 0x00, 0x38, 0x00, 0x67, 0x00, 0x51, 0x00, 0x32, 0x00, 0x39, 0x00, 0x79, 0x00, 0x63, 0x00, 0x47, 0x00,
            0x39, 0x00, 0x79, 0x00, 0x59, 0x00, 0x58, 0x00, 0x52, 0x00, 0x70, 0x00, 0x62, 0x00, 0x32, 0x00, 0x34, 0x00,
            0x78, 0x00, 0x47, 0x00, 0x54, 0x00, 0x41, 0x00, 0x58, 0x00, 0x42, 0x00, 0x67, 0x00, 0x4E, 0x00, 0x56, 0x00,
            0x42, 0x00, 0x41, 0x00, 0x4D, 0x00, 0x4D, 0x00, 0x45, 0x00, 0x45, 0x00, 0x4E, 0x00, 0x76, 0x00, 0x62, 0x00,
            0x6E, 0x00, 0x52, 0x00, 0x76, 0x00, 0x63, 0x00, 0x32, 0x00, 0x38, 0x00, 0x67, 0x00, 0x0D, 0x00, 0x0A, 0x00,
            0x23, 0x00, 0x20, 0x00, 0x55, 0x00, 0x32, 0x00, 0x39, 0x00, 0x6D, 0x00, 0x64, 0x00, 0x48, 0x00, 0x64, 0x00,
            0x68, 0x00, 0x63, 0x00, 0x6D, 0x00, 0x55, 0x00, 0x77, 0x00, 0x67, 0x00, 0x67, 0x00, 0x45, 0x00, 0x69, 0x00,
            0x4D, 0x00, 0x41, 0x00, 0x30, 0x00, 0x47, 0x00, 0x43, 0x00, 0x53, 0x00, 0x71, 0x00, 0x47, 0x00, 0x53, 0x00,
            0x49, 0x00, 0x62, 0x00, 0x33, 0x00, 0x44, 0x00, 0x51, 0x00, 0x45, 0x00, 0x42, 0x00, 0x41, 0x00, 0x51, 0x00,
            0x55, 0x00, 0x41, 0x00, 0x41, 0x00, 0x34, 0x00, 0x49, 0x00, 0x42, 0x00, 0x44, 0x00, 0x77, 0x00, 0x41, 0x00,
            0x77, 0x00, 0x67, 0x00, 0x67, 0x00, 0x45, 0x00, 0x4B, 0x00, 0x41, 0x00, 0x6F, 0x00, 0x49, 0x00, 0x42, 0x00,
            0x41, 0x00, 0x51, 0x00, 0x44, 0x00, 0x52, 0x00, 0x77, 0x00, 0x4C, 0x00, 0x6D, 0x00, 0x52, 0x00, 0x71, 0x00,
            0x46, 0x00, 0x56, 0x00, 0x5A, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x56, 0x00, 0x63, 0x00,
            0x39, 0x00, 0x52, 0x00, 0x55, 0x00, 0x50, 0x00, 0x49, 0x00, 0x64, 0x00, 0x48, 0x00, 0x55, 0x00, 0x6E, 0x00,
            0x4D, 0x00, 0x51, 0x00, 0x6C, 0x00, 0x48, 0x00, 0x42, 0x00, 0x6C, 0x00, 0x33, 0x00, 0x6C, 0x00, 0x78, 0x00,
            0x6D, 0x00, 0x36, 0x00, 0x75, 0x00, 0x6D, 0x00, 0x70, 0x00, 0x68, 0x00, 0x36, 0x00, 0x61, 0x00, 0x43, 0x00,
            0x55, 0x00, 0x2B, 0x00, 0x6C, 0x00, 0x4E, 0x00, 0x55, 0x00, 0x64, 0x00, 0x35, 0x00, 0x76, 0x00, 0x2F, 0x00,
            0x35, 0x00, 0x72, 0x00, 0x65, 0x00, 0x59, 0x00, 0x35, 0x00, 0x4A, 0x00, 0x51, 0x00, 0x42, 0x00, 0x44, 0x00,
            0x68, 0x00, 0x32, 0x00, 0x32, 0x00, 0x75, 0x00, 0x75, 0x00, 0x74, 0x00, 0x36, 0x00, 0x64, 0x00, 0x7A, 0x00,
            0x69, 0x00, 0x52, 0x00, 0x6C, 0x00, 0x71, 0x00, 0x38, 0x00, 0x38, 0x00, 0x58, 0x00, 0x74, 0x00, 0x0D, 0x00,
            0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x4E, 0x00, 0x39, 0x00, 0x77, 0x00, 0x69, 0x00, 0x67, 0x00, 0x43, 0x00,
            0x68, 0x00, 0x79, 0x00, 0x4D, 0x00, 0x49, 0x00, 0x6F, 0x00, 0x47, 0x00, 0x49, 0x00, 0x69, 0x00, 0x55, 0x00,
            0x72, 0x00, 0x76, 0x00, 0x64, 0x00, 0x44, 0x00, 0x52, 0x00, 0x70, 0x00, 0x4C, 0x00, 0x4F, 0x00, 0x71, 0x00,
            0x4D, 0x00, 0x58, 0x00, 0x34, 0x00, 0x46, 0x00, 0x43, 0x00, 0x43, 0x00, 0x4E, 0x00, 0x62, 0x00, 0x62, 0x00,
            0x69, 0x00, 0x6A, 0x00, 0x65, 0x00, 0x61, 0x00, 0x6F, 0x00, 0x4D, 0x00, 0x4E, 0x00, 0x51, 0x00, 0x61, 0x00,
            0x2B, 0x00, 0x78, 0x00, 0x32, 0x00, 0x6F, 0x00, 0x6C, 0x00, 0x35, 0x00, 0x47, 0x00, 0x50, 0x00, 0x76, 0x00,
            0x45, 0x00, 0x56, 0x00, 0x37, 0x00, 0x77, 0x00, 0x61, 0x00, 0x55, 0x00, 0x4F, 0x00, 0x63, 0x00, 0x30, 0x00,
            0x65, 0x00, 0x50, 0x00, 0x31, 0x00, 0x76, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x47, 0x00,
            0x56, 0x00, 0x51, 0x00, 0x63, 0x00, 0x4B, 0x00, 0x4C, 0x00, 0x78, 0x00, 0x31, 0x00, 0x71, 0x00, 0x67, 0x00,
            0x56, 0x00, 0x6F, 0x00, 0x38, 0x00, 0x75, 0x00, 0x2B, 0x00, 0x4B, 0x00, 0x34, 0x00, 0x42, 0x00, 0x76, 0x00,
            0x33, 0x00, 0x4D, 0x00, 0x66, 0x00, 0x38, 0x00, 0x71, 0x00, 0x45, 0x00, 0x31, 0x00, 0x61, 0x00, 0x44, 0x00,
            0x75, 0x00, 0x36, 0x00, 0x6D, 0x00, 0x64, 0x00, 0x50, 0x00, 0x6F, 0x00, 0x72, 0x00, 0x51, 0x00, 0x76, 0x00,
            0x6F, 0x00, 0x61, 0x00, 0x72, 0x00, 0x6E, 0x00, 0x58, 0x00, 0x57, 0x00, 0x30, 0x00, 0x71, 0x00, 0x44, 0x00,
            0x38, 0x00, 0x77, 0x00, 0x2B, 0x00, 0x43, 0x00, 0x35, 0x00, 0x6E, 0x00, 0x54, 0x00, 0x52, 0x00, 0x58, 0x00,
            0x33, 0x00, 0x69, 0x00, 0x42, 0x00, 0x38, 0x00, 0x48, 0x00, 0x61, 0x00, 0x51, 0x00, 0x75, 0x00, 0x5A, 0x00,
            0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x59, 0x00, 0x44, 0x00, 0x2B, 0x00, 0x39, 0x00, 0x6B, 0x00,
            0x6F, 0x00, 0x53, 0x00, 0x32, 0x00, 0x5A, 0x00, 0x4A, 0x00, 0x6B, 0x00, 0x48, 0x00, 0x64, 0x00, 0x49, 0x00,
            0x6B, 0x00, 0x37, 0x00, 0x65, 0x00, 0x6F, 0x00, 0x6A, 0x00, 0x69, 0x00, 0x4A, 0x00, 0x45, 0x00, 0x30, 0x00,
            0x48, 0x00, 0x56, 0x00, 0x38, 0x00, 0x75, 0x00, 0x30, 0x00, 0x42, 0x00, 0x59, 0x00, 0x62, 0x00, 0x61, 0x00,
            0x44, 0x00, 0x66, 0x00, 0x33, 0x00, 0x36, 0x00, 0x32, 0x00, 0x49, 0x00, 0x79, 0x00, 0x70, 0x00, 0x45, 0x00,
            0x72, 0x00, 0x51, 0x00, 0x43, 0x00, 0x69, 0x00, 0x66, 0x00, 0x2F, 0x00, 0x44, 0x00, 0x67, 0x00, 0x6C, 0x00,
            0x31, 0x00, 0x49, 0x00, 0x4F, 0x00, 0x4A, 0x00, 0x41, 0x00, 0x4B, 0x00, 0x50, 0x00, 0x39, 0x00, 0x78, 0x00,
            0x41, 0x00, 0x6D, 0x00, 0x72, 0x00, 0x46, 0x00, 0x62, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00,
            0x67, 0x00, 0x73, 0x00, 0x49, 0x00, 0x2F, 0x00, 0x59, 0x00, 0x32, 0x00, 0x4F, 0x00, 0x37, 0x00, 0x63, 0x00,
            0x48, 0x00, 0x73, 0x00, 0x4E, 0x00, 0x6A, 0x00, 0x30, 0x00, 0x31, 0x00, 0x56, 0x00, 0x7A, 0x00, 0x75, 0x00,
            0x52, 0x00, 0x74, 0x00, 0x44, 0x00, 0x6F, 0x00, 0x4B, 0x00, 0x6C, 0x00, 0x4B, 0x00, 0x2F, 0x00, 0x2B, 0x00,
            0x70, 0x00, 0x53, 0x00, 0x4B, 0x00, 0x32, 0x00, 0x71, 0x00, 0x51, 0x00, 0x66, 0x00, 0x56, 0x00, 0x2F, 0x00,
            0x56, 0x00, 0x62, 0x00, 0x73, 0x00, 0x55, 0x00, 0x7A, 0x00, 0x43, 0x00, 0x58, 0x00, 0x4C, 0x00, 0x4B, 0x00,
            0x41, 0x00, 0x78, 0x00, 0x4A, 0x00, 0x51, 0x00, 0x57, 0x00, 0x32, 0x00, 0x43, 0x00, 0x69, 0x00, 0x67, 0x00,
            0x36, 0x00, 0x46, 0x00, 0x37, 0x00, 0x42, 0x00, 0x36, 0x00, 0x52, 0x00, 0x61, 0x00, 0x48, 0x00, 0x72, 0x00,
            0x57, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x50, 0x00, 0x4B, 0x00, 0x66, 0x00, 0x50, 0x00,
            0x41, 0x00, 0x6E, 0x00, 0x69, 0x00, 0x49, 0x00, 0x44, 0x00, 0x73, 0x00, 0x64, 0x00, 0x64, 0x00, 0x41, 0x00,
            0x67, 0x00, 0x4D, 0x00, 0x42, 0x00, 0x41, 0x00, 0x41, 0x00, 0x47, 0x00, 0x6A, 0x00, 0x56, 0x00, 0x44, 0x00,
            0x42, 0x00, 0x53, 0x00, 0x4D, 0x00, 0x41, 0x00, 0x34, 0x00, 0x47, 0x00, 0x41, 0x00, 0x31, 0x00, 0x55, 0x00,
            0x64, 0x00, 0x44, 0x00, 0x77, 0x00, 0x45, 0x00, 0x42, 0x00, 0x2F, 0x00, 0x77, 0x00, 0x51, 0x00, 0x45, 0x00,
            0x41, 0x00, 0x77, 0x00, 0x49, 0x00, 0x48, 0x00, 0x67, 0x00, 0x44, 0x00, 0x41, 0x00, 0x54, 0x00, 0x42, 0x00,
            0x67, 0x00, 0x4E, 0x00, 0x56, 0x00, 0x48, 0x00, 0x53, 0x00, 0x55, 0x00, 0x45, 0x00, 0x44, 0x00, 0x44, 0x00,
            0x41, 0x00, 0x4B, 0x00, 0x42, 0x00, 0x67, 0x00, 0x67, 0x00, 0x72, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00,
            0x20, 0x00, 0x42, 0x00, 0x67, 0x00, 0x45, 0x00, 0x46, 0x00, 0x42, 0x00, 0x51, 0x00, 0x63, 0x00, 0x44, 0x00,
            0x41, 0x00, 0x7A, 0x00, 0x41, 0x00, 0x4D, 0x00, 0x42, 0x00, 0x67, 0x00, 0x4E, 0x00, 0x56, 0x00, 0x48, 0x00,
            0x52, 0x00, 0x4D, 0x00, 0x42, 0x00, 0x41, 0x00, 0x66, 0x00, 0x38, 0x00, 0x45, 0x00, 0x41, 0x00, 0x6A, 0x00,
            0x41, 0x00, 0x41, 0x00, 0x4D, 0x00, 0x42, 0x00, 0x30, 0x00, 0x47, 0x00, 0x41, 0x00, 0x31, 0x00, 0x55, 0x00,
            0x64, 0x00, 0x44, 0x00, 0x67, 0x00, 0x51, 0x00, 0x57, 0x00, 0x42, 0x00, 0x42, 0x00, 0x52, 0x00, 0x70, 0x00,
            0x79, 0x00, 0x69, 0x00, 0x52, 0x00, 0x68, 0x00, 0x5A, 0x00, 0x46, 0x00, 0x44, 0x00, 0x72, 0x00, 0x4C, 0x00,
            0x62, 0x00, 0x66, 0x00, 0x6B, 0x00, 0x55, 0x00, 0x39, 0x00, 0x32, 0x00, 0x45, 0x00, 0x51, 0x00, 0x71, 0x00,
            0x41, 0x00, 0x66, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x63, 0x00, 0x62, 0x00, 0x69, 0x00,
            0x4B, 0x00, 0x75, 0x00, 0x7A, 0x00, 0x41, 0x00, 0x4E, 0x00, 0x42, 0x00, 0x67, 0x00, 0x6B, 0x00, 0x71, 0x00,
            0x68, 0x00, 0x6B, 0x00, 0x69, 0x00, 0x47, 0x00, 0x39, 0x00, 0x77, 0x00, 0x30, 0x00, 0x42, 0x00, 0x41, 0x00,
            0x51, 0x00, 0x73, 0x00, 0x46, 0x00, 0x41, 0x00, 0x41, 0x00, 0x4F, 0x00, 0x43, 0x00, 0x41, 0x00, 0x51, 0x00,
            0x45, 0x00, 0x41, 0x00, 0x52, 0x00, 0x4F, 0x00, 0x4E, 0x00, 0x6F, 0x00, 0x4D, 0x00, 0x71, 0x00, 0x6A, 0x00,
            0x6D, 0x00, 0x70, 0x00, 0x6F, 0x00, 0x4A, 0x00, 0x30, 0x00, 0x39, 0x00, 0x48, 0x00, 0x4E, 0x00, 0x44, 0x00,
            0x78, 0x00, 0x78, 0x00, 0x6F, 0x00, 0x32, 0x00, 0x67, 0x00, 0x71, 0x00, 0x74, 0x00, 0x32, 0x00, 0x6C, 0x00,
            0x48, 0x00, 0x6D, 0x00, 0x63, 0x00, 0x32, 0x00, 0x68, 0x00, 0x4F, 0x00, 0x38, 0x00, 0x0D, 0x00, 0x0A, 0x00,
            0x23, 0x00, 0x20, 0x00, 0x4B, 0x00, 0x70, 0x00, 0x6D, 0x00, 0x53, 0x00, 0x73, 0x00, 0x71, 0x00, 0x6E, 0x00,
            0x6E, 0x00, 0x62, 0x00, 0x36, 0x00, 0x39, 0x00, 0x4F, 0x00, 0x6C, 0x00, 0x4F, 0x00, 0x61, 0x00, 0x4C, 0x00,
            0x6E, 0x00, 0x35, 0x00, 0x4B, 0x00, 0x51, 0x00, 0x62, 0x00, 0x33, 0x00, 0x56, 0x00, 0x7A, 0x00, 0x78, 0x00,
            0x75, 0x00, 0x4D, 0x00, 0x45, 0x00, 0x64, 0x00, 0x35, 0x00, 0x77, 0x00, 0x34, 0x00, 0x79, 0x00, 0x72, 0x00,
            0x77, 0x00, 0x79, 0x00, 0x58, 0x00, 0x75, 0x00, 0x4F, 0x00, 0x4F, 0x00, 0x32, 0x00, 0x71, 0x00, 0x56, 0x00,
            0x57, 0x00, 0x39, 0x00, 0x52, 0x00, 0x55, 0x00, 0x64, 0x00, 0x36, 0x00, 0x4D, 0x00, 0x46, 0x00, 0x4B, 0x00,
            0x69, 0x00, 0x5A, 0x00, 0x35, 0x00, 0x71, 0x00, 0x2B, 0x00, 0x37, 0x00, 0x69, 0x00, 0x74, 0x00, 0x4C, 0x00,
            0x67, 0x00, 0x39, 0x00, 0x34, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x32, 0x00, 0x5A, 0x00,
            0x67, 0x00, 0x2B, 0x00, 0x4A, 0x00, 0x61, 0x00, 0x6E, 0x00, 0x43, 0x00, 0x6C, 0x00, 0x4F, 0x00, 0x44, 0x00,
            0x63, 0x00, 0x61, 0x00, 0x64, 0x00, 0x6A, 0x00, 0x63, 0x00, 0x48, 0x00, 0x52, 0x00, 0x6D, 0x00, 0x4A, 0x00,
            0x4A, 0x00, 0x71, 0x00, 0x78, 0x00, 0x4F, 0x00, 0x74, 0x00, 0x6A, 0x00, 0x44, 0x00, 0x58, 0x00, 0x78, 0x00,
            0x42, 0x00, 0x30, 0x00, 0x30, 0x00, 0x6C, 0x00, 0x2B, 0x00, 0x47, 0x00, 0x39, 0x00, 0x50, 0x00, 0x39, 0x00,
            0x63, 0x00, 0x64, 0x00, 0x30, 0x00, 0x73, 0x00, 0x30, 0x00, 0x68, 0x00, 0x61, 0x00, 0x35, 0x00, 0x48, 0x00,
            0x75, 0x00, 0x31, 0x00, 0x51, 0x00, 0x4A, 0x00, 0x65, 0x00, 0x6E, 0x00, 0x4B, 0x00, 0x38, 0x00, 0x43, 0x00,
            0x37, 0x00, 0x63, 0x00, 0x43, 0x00, 0x6E, 0x00, 0x76, 0x00, 0x6B, 0x00, 0x4E, 0x00, 0x77, 0x00, 0x0D, 0x00,
            0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x44, 0x00, 0x45, 0x00, 0x46, 0x00, 0x51, 0x00, 0x65, 0x00, 0x77, 0x00,
            0x41, 0x00, 0x6F, 0x00, 0x39, 0x00, 0x46, 0x00, 0x76, 0x00, 0x36, 0x00, 0x34, 0x00, 0x42, 0x00, 0x56, 0x00,
            0x6B, 0x00, 0x37, 0x00, 0x4A, 0x00, 0x44, 0x00, 0x58, 0x00, 0x4B, 0x00, 0x68, 0x00, 0x67, 0x00, 0x48, 0x00,
            0x57, 0x00, 0x62, 0x00, 0x6E, 0x00, 0x70, 0x00, 0x50, 0x00, 0x6C, 0x00, 0x62, 0x00, 0x61, 0x00, 0x44, 0x00,
            0x65, 0x00, 0x66, 0x00, 0x71, 0x00, 0x74, 0x00, 0x36, 0x00, 0x4F, 0x00, 0x5A, 0x00, 0x68, 0x00, 0x6E, 0x00,
            0x53, 0x00, 0x73, 0x00, 0x6C, 0x00, 0x6E, 0x00, 0x4A, 0x00, 0x33, 0x00, 0x73, 0x00, 0x6E, 0x00, 0x34, 0x00,
            0x31, 0x00, 0x55, 0x00, 0x70, 0x00, 0x38, 0x00, 0x51, 0x00, 0x65, 0x00, 0x41, 0x00, 0x65, 0x00, 0x4F, 0x00,
            0x74, 0x00, 0x35, 0x00, 0x4C, 0x00, 0x55, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x30, 0x00,
            0x4E, 0x00, 0x51, 0x00, 0x65, 0x00, 0x2B, 0x00, 0x5A, 0x00, 0x6B, 0x00, 0x2F, 0x00, 0x70, 0x00, 0x44, 0x00,
            0x6B, 0x00, 0x32, 0x00, 0x6B, 0x00, 0x48, 0x00, 0x6B, 0x00, 0x6F, 0x00, 0x6D, 0x00, 0x2F, 0x00, 0x75, 0x00,
            0x42, 0x00, 0x46, 0x00, 0x31, 0x00, 0x76, 0x00, 0x36, 0x00, 0x32, 0x00, 0x36, 0x00, 0x43, 0x00, 0x37, 0x00,
            0x4C, 0x00, 0x43, 0x00, 0x4B, 0x00, 0x41, 0x00, 0x68, 0x00, 0x68, 0x00, 0x61, 0x00, 0x4F, 0x00, 0x76, 0x00,
            0x4B, 0x00, 0x71, 0x00, 0x77, 0x00, 0x4F, 0x00, 0x68, 0x00, 0x53, 0x00, 0x42, 0x00, 0x72, 0x00, 0x44, 0x00,
            0x67, 0x00, 0x45, 0x00, 0x65, 0x00, 0x4F, 0x00, 0x33, 0x00, 0x61, 0x00, 0x4F, 0x00, 0x72, 0x00, 0x57, 0x00,
            0x74, 0x00, 0x38, 0x00, 0x64, 0x00, 0x62, 0x00, 0x62, 0x00, 0x56, 0x00, 0x4A, 0x00, 0x4D, 0x00, 0x62, 0x00,
            0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x41, 0x00, 0x47, 0x00, 0x38, 0x00, 0x4E, 0x00, 0x71, 0x00,
            0x70, 0x00, 0x72, 0x00, 0x59, 0x00, 0x63, 0x00, 0x6F, 0x00, 0x2B, 0x00, 0x69, 0x00, 0x6E, 0x00, 0x77, 0x00,
            0x67, 0x00, 0x36, 0x00, 0x46, 0x00, 0x2B, 0x00, 0x44, 0x00, 0x4B, 0x00, 0x73, 0x00, 0x74, 0x00, 0x36, 0x00,
            0x78, 0x00, 0x32, 0x00, 0x4C, 0x00, 0x66, 0x00, 0x4F, 0x00, 0x4B, 0x00, 0x45, 0x00, 0x74, 0x00, 0x4F, 0x00,
            0x48, 0x00, 0x76, 0x00, 0x45, 0x00, 0x78, 0x00, 0x69, 0x00, 0x57, 0x00, 0x66, 0x00, 0x33, 0x00, 0x4C, 0x00,
            0x33, 0x00, 0x76, 0x00, 0x6E, 0x00, 0x38, 0x00, 0x34, 0x00, 0x68, 0x00, 0x72, 0x00, 0x68, 0x00, 0x78, 0x00,
            0x49, 0x00, 0x46, 0x00, 0x53, 0x00, 0x54, 0x00, 0x47, 0x00, 0x43, 0x00, 0x41, 0x00, 0x67, 0x00, 0x4D, 0x00,
            0x77, 0x00, 0x67, 0x00, 0x67, 0x00, 0x48, 0x00, 0x2F, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00,
            0x41, 0x00, 0x67, 0x00, 0x45, 0x00, 0x42, 0x00, 0x4D, 0x00, 0x46, 0x00, 0x6F, 0x00, 0x77, 0x00, 0x52, 0x00,
            0x6A, 0x00, 0x45, 0x00, 0x4C, 0x00, 0x4D, 0x00, 0x41, 0x00, 0x6B, 0x00, 0x47, 0x00, 0x41, 0x00, 0x31, 0x00,
            0x55, 0x00, 0x45, 0x00, 0x42, 0x00, 0x68, 0x00, 0x4D, 0x00, 0x43, 0x00, 0x56, 0x00, 0x56, 0x00, 0x4D, 0x00,
            0x78, 0x00, 0x48, 0x00, 0x44, 0x00, 0x41, 0x00, 0x61, 0x00, 0x42, 0x00, 0x67, 0x00, 0x4E, 0x00, 0x56, 0x00,
            0x42, 0x00, 0x41, 0x00, 0x6F, 0x00, 0x4D, 0x00, 0x45, 0x00, 0x30, 0x00, 0x4E, 0x00, 0x76, 0x00, 0x62, 0x00,
            0x6E, 0x00, 0x52, 0x00, 0x76, 0x00, 0x63, 0x00, 0x32, 0x00, 0x38, 0x00, 0x67, 0x00, 0x51, 0x00, 0x32, 0x00,
            0x39, 0x00, 0x79, 0x00, 0x63, 0x00, 0x47, 0x00, 0x39, 0x00, 0x79, 0x00, 0x59, 0x00, 0x58, 0x00, 0x52, 0x00,
            0x70, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x62, 0x00, 0x32, 0x00, 0x34, 0x00, 0x78, 0x00,
            0x47, 0x00, 0x54, 0x00, 0x41, 0x00, 0x58, 0x00, 0x42, 0x00, 0x67, 0x00, 0x4E, 0x00, 0x56, 0x00, 0x42, 0x00,
            0x41, 0x00, 0x4D, 0x00, 0x4D, 0x00, 0x45, 0x00, 0x45, 0x00, 0x4E, 0x00, 0x76, 0x00, 0x62, 0x00, 0x6E, 0x00,
            0x52, 0x00, 0x76, 0x00, 0x63, 0x00, 0x32, 0x00, 0x38, 0x00, 0x67, 0x00, 0x55, 0x00, 0x32, 0x00, 0x39, 0x00,
            0x6D, 0x00, 0x64, 0x00, 0x48, 0x00, 0x64, 0x00, 0x68, 0x00, 0x63, 0x00, 0x6D, 0x00, 0x55, 0x00, 0x43, 0x00,
            0x45, 0x00, 0x44, 0x00, 0x4D, 0x00, 0x43, 0x00, 0x34, 0x00, 0x44, 0x00, 0x32, 0x00, 0x67, 0x00, 0x6E, 0x00,
            0x67, 0x00, 0x57, 0x00, 0x59, 0x00, 0x52, 0x00, 0x6F, 0x00, 0x49, 0x00, 0x39, 0x00, 0x36, 0x00, 0x69, 0x00,
            0x69, 0x00, 0x4F, 0x00, 0x73, 0x00, 0x45, 0x00, 0x38, 0x00, 0x77, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00,
            0x20, 0x00, 0x44, 0x00, 0x51, 0x00, 0x59, 0x00, 0x4A, 0x00, 0x59, 0x00, 0x49, 0x00, 0x5A, 0x00, 0x49, 0x00,
            0x41, 0x00, 0x57, 0x00, 0x55, 0x00, 0x44, 0x00, 0x42, 0x00, 0x41, 0x00, 0x49, 0x00, 0x42, 0x00, 0x42, 0x00,
            0x51, 0x00, 0x43, 0x00, 0x67, 0x00, 0x66, 0x00, 0x44, 0x00, 0x41, 0x00, 0x51, 0x00, 0x42, 0x00, 0x67, 0x00,
            0x6F, 0x00, 0x72, 0x00, 0x42, 0x00, 0x67, 0x00, 0x45, 0x00, 0x45, 0x00, 0x41, 0x00, 0x59, 0x00, 0x49, 0x00,
            0x33, 0x00, 0x41, 0x00, 0x67, 0x00, 0x45, 0x00, 0x4D, 0x00, 0x4D, 0x00, 0x51, 0x00, 0x49, 0x00, 0x77, 0x00,
            0x41, 0x00, 0x44, 0x00, 0x41, 0x00, 0x5A, 0x00, 0x42, 0x00, 0x67, 0x00, 0x6B, 0x00, 0x71, 0x00, 0x68, 0x00,
            0x6B, 0x00, 0x69, 0x00, 0x47, 0x00, 0x39, 0x00, 0x77, 0x00, 0x30, 0x00, 0x42, 0x00, 0x43, 0x00, 0x51, 0x00,
            0x4D, 0x00, 0x78, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x44, 0x00, 0x41, 0x00, 0x59, 0x00,
            0x4B, 0x00, 0x4B, 0x00, 0x77, 0x00, 0x59, 0x00, 0x42, 0x00, 0x42, 0x00, 0x41, 0x00, 0x47, 0x00, 0x43, 0x00,
            0x4E, 0x00, 0x77, 0x00, 0x49, 0x00, 0x42, 0x00, 0x42, 0x00, 0x44, 0x00, 0x41, 0x00, 0x63, 0x00, 0x42, 0x00,
            0x67, 0x00, 0x6F, 0x00, 0x72, 0x00, 0x42, 0x00, 0x67, 0x00, 0x45, 0x00, 0x45, 0x00, 0x41, 0x00, 0x59, 0x00,
            0x49, 0x00, 0x33, 0x00, 0x41, 0x00, 0x67, 0x00, 0x45, 0x00, 0x4C, 0x00, 0x4D, 0x00, 0x51, 0x00, 0x34, 0x00,
            0x77, 0x00, 0x44, 0x00, 0x41, 0x00, 0x59, 0x00, 0x4B, 0x00, 0x4B, 0x00, 0x77, 0x00, 0x59, 0x00, 0x42, 0x00,
            0x42, 0x00, 0x41, 0x00, 0x47, 0x00, 0x43, 0x00, 0x4E, 0x00, 0x77, 0x00, 0x49, 0x00, 0x42, 0x00, 0x46, 0x00,
            0x54, 0x00, 0x41, 0x00, 0x76, 0x00, 0x42, 0x00, 0x67, 0x00, 0x6B, 0x00, 0x71, 0x00, 0x0D, 0x00, 0x0A, 0x00,
            0x23, 0x00, 0x20, 0x00, 0x68, 0x00, 0x6B, 0x00, 0x69, 0x00, 0x47, 0x00, 0x39, 0x00, 0x77, 0x00, 0x30, 0x00,
            0x42, 0x00, 0x43, 0x00, 0x51, 0x00, 0x51, 0x00, 0x78, 0x00, 0x49, 0x00, 0x67, 0x00, 0x51, 0x00, 0x67, 0x00,
            0x4D, 0x00, 0x79, 0x00, 0x2F, 0x00, 0x2B, 0x00, 0x51, 0x00, 0x4A, 0x00, 0x67, 0x00, 0x45, 0x00, 0x34, 0x00,
            0x46, 0x00, 0x41, 0x00, 0x74, 0x00, 0x48, 0x00, 0x42, 0x00, 0x47, 0x00, 0x73, 0x00, 0x6A, 0x00, 0x66, 0x00,
            0x38, 0x00, 0x5A, 0x00, 0x45, 0x00, 0x31, 0x00, 0x4B, 0x00, 0x6E, 0x00, 0x48, 0x00, 0x5A, 0x00, 0x2B, 0x00,
            0x59, 0x00, 0x64, 0x00, 0x75, 0x00, 0x49, 0x00, 0x6E, 0x00, 0x61, 0x00, 0x74, 0x00, 0x59, 0x00, 0x74, 0x00,
            0x4C, 0x00, 0x7A, 0x00, 0x6F, 0x00, 0x6A, 0x00, 0x75, 0x00, 0x43, 0x00, 0x67, 0x00, 0x77, 0x00, 0x44, 0x00,
            0x51, 0x00, 0x59, 0x00, 0x4A, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x4B, 0x00, 0x6F, 0x00,
            0x5A, 0x00, 0x49, 0x00, 0x68, 0x00, 0x76, 0x00, 0x63, 0x00, 0x4E, 0x00, 0x41, 0x00, 0x51, 0x00, 0x45, 0x00,
            0x42, 0x00, 0x42, 0x00, 0x51, 0x00, 0x41, 0x00, 0x45, 0x00, 0x67, 0x00, 0x67, 0x00, 0x45, 0x00, 0x41, 0x00,
            0x65, 0x00, 0x39, 0x00, 0x35, 0x00, 0x38, 0x00, 0x49, 0x00, 0x72, 0x00, 0x53, 0x00, 0x33, 0x00, 0x63, 0x00,
            0x33, 0x00, 0x55, 0x00, 0x79, 0x00, 0x2B, 0x00, 0x53, 0x00, 0x59, 0x00, 0x57, 0x00, 0x37, 0x00, 0x4A, 0x00,
            0x61, 0x00, 0x70, 0x00, 0x70, 0x00, 0x50, 0x00, 0x53, 0x00, 0x62, 0x00, 0x38, 0x00, 0x6E, 0x00, 0x56, 0x00,
            0x38, 0x00, 0x77, 0x00, 0x7A, 0x00, 0x36, 0x00, 0x72, 0x00, 0x35, 0x00, 0x43, 0x00, 0x39, 0x00, 0x6F, 0x00,
            0x4F, 0x00, 0x61, 0x00, 0x44, 0x00, 0x6A, 0x00, 0x71, 0x00, 0x44, 0x00, 0x65, 0x00, 0x45, 0x00, 0x0D, 0x00,
            0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x4A, 0x00, 0x6D, 0x00, 0x2B, 0x00, 0x41, 0x00, 0x43, 0x00, 0x54, 0x00,
            0x55, 0x00, 0x61, 0x00, 0x5A, 0x00, 0x6F, 0x00, 0x43, 0x00, 0x74, 0x00, 0x58, 0x00, 0x68, 0x00, 0x46, 0x00,
            0x55, 0x00, 0x35, 0x00, 0x33, 0x00, 0x6B, 0x00, 0x30, 0x00, 0x38, 0x00, 0x59, 0x00, 0x77, 0x00, 0x37, 0x00,
            0x49, 0x00, 0x49, 0x00, 0x72, 0x00, 0x6E, 0x00, 0x4B, 0x00, 0x4D, 0x00, 0x74, 0x00, 0x53, 0x00, 0x4F, 0x00,
            0x4B, 0x00, 0x30, 0x00, 0x6B, 0x00, 0x39, 0x00, 0x47, 0x00, 0x4E, 0x00, 0x64, 0x00, 0x46, 0x00, 0x6A, 0x00,
            0x2B, 0x00, 0x58, 0x00, 0x66, 0x00, 0x6F, 0x00, 0x6D, 0x00, 0x31, 0x00, 0x53, 0x00, 0x56, 0x00, 0x51, 0x00,
            0x72, 0x00, 0x74, 0x00, 0x56, 0x00, 0x71, 0x00, 0x31, 0x00, 0x65, 0x00, 0x52, 0x00, 0x38, 0x00, 0x41, 0x00,
            0x39, 0x00, 0x38, 0x00, 0x63, 0x00, 0x47, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x37, 0x00,
            0x57, 0x00, 0x66, 0x00, 0x78, 0x00, 0x32, 0x00, 0x51, 0x00, 0x6A, 0x00, 0x64, 0x00, 0x4F, 0x00, 0x54, 0x00,
            0x52, 0x00, 0x30, 0x00, 0x47, 0x00, 0x74, 0x00, 0x63, 0x00, 0x38, 0x00, 0x46, 0x00, 0x77, 0x00, 0x4D, 0x00,
            0x31, 0x00, 0x75, 0x00, 0x34, 0x00, 0x6E, 0x00, 0x4D, 0x00, 0x45, 0x00, 0x72, 0x00, 0x57, 0x00, 0x52, 0x00,
            0x71, 0x00, 0x66, 0x00, 0x34, 0x00, 0x6E, 0x00, 0x63, 0x00, 0x39, 0x00, 0x44, 0x00, 0x70, 0x00, 0x49, 0x00,
            0x77, 0x00, 0x6D, 0x00, 0x70, 0x00, 0x57, 0x00, 0x51, 0x00, 0x2B, 0x00, 0x58, 0x00, 0x66, 0x00, 0x69, 0x00,
            0x69, 0x00, 0x6F, 0x00, 0x46, 0x00, 0x4A, 0x00, 0x51, 0x00, 0x48, 0x00, 0x59, 0x00, 0x74, 0x00, 0x51, 0x00,
            0x52, 0x00, 0x6F, 0x00, 0x51, 0x00, 0x42, 0x00, 0x61, 0x00, 0x69, 0x00, 0x32, 0x00, 0x7A, 0x00, 0x42, 0x00,
            0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x4B, 0x00, 0x70, 0x00, 0x57, 0x00, 0x6B, 0x00, 0x62, 0x00,
            0x61, 0x00, 0x64, 0x00, 0x6A, 0x00, 0x47, 0x00, 0x4D, 0x00, 0x45, 0x00, 0x64, 0x00, 0x4A, 0x00, 0x44, 0x00,
            0x71, 0x00, 0x46, 0x00, 0x4E, 0x00, 0x55, 0x00, 0x79, 0x00, 0x61, 0x00, 0x69, 0x00, 0x45, 0x00, 0x4F, 0x00,
            0x6F, 0x00, 0x47, 0x00, 0x68, 0x00, 0x4E, 0x00, 0x4B, 0x00, 0x53, 0x00, 0x56, 0x00, 0x65, 0x00, 0x45, 0x00,
            0x70, 0x00, 0x68, 0x00, 0x6E, 0x00, 0x41, 0x00, 0x34, 0x00, 0x73, 0x00, 0x48, 0x00, 0x71, 0x00, 0x74, 0x00,
            0x77, 0x00, 0x2F, 0x00, 0x30, 0x00, 0x64, 0x00, 0x6E, 0x00, 0x77, 0x00, 0x39, 0x00, 0x6F, 0x00, 0x72, 0x00,
            0x76, 0x00, 0x78, 0x00, 0x66, 0x00, 0x34, 0x00, 0x6E, 0x00, 0x57, 0x00, 0x70, 0x00, 0x4B, 0x00, 0x50, 0x00,
            0x7A, 0x00, 0x42, 0x00, 0x64, 0x00, 0x56, 0x00, 0x56, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00,
            0x5A, 0x00, 0x42, 0x00, 0x77, 0x00, 0x6A, 0x00, 0x56, 0x00, 0x5A, 0x00, 0x68, 0x00, 0x4B, 0x00, 0x4C, 0x00,
            0x51, 0x00, 0x66, 0x00, 0x70, 0x00, 0x35, 0x00, 0x50, 0x00, 0x72, 0x00, 0x75, 0x00, 0x68, 0x00, 0x5A, 0x00,
            0x6A, 0x00, 0x30, 0x00, 0x48, 0x00, 0x6C, 0x00, 0x30, 0x00, 0x4D, 0x00, 0x52, 0x00, 0x7A, 0x00, 0x41, 0x00,
            0x63, 0x00, 0x4C, 0x00, 0x4E, 0x00, 0x61, 0x00, 0x61, 0x00, 0x4F, 0x00, 0x76, 0x00, 0x32, 0x00, 0x76, 0x00,
            0x34, 0x00, 0x50, 0x00, 0x73, 0x00, 0x67, 0x00, 0x51, 0x00, 0x6D, 0x00, 0x68, 0x00, 0x72, 0x00, 0x56, 0x00,
            0x65, 0x00, 0x42, 0x00, 0x79, 0x00, 0x41, 0x00, 0x66, 0x00, 0x39, 0x00, 0x47, 0x00, 0x44, 0x00, 0x2F, 0x00,
            0x35, 0x00, 0x67, 0x00, 0x7A, 0x00, 0x6E, 0x00, 0x67, 0x00, 0x73, 0x00, 0x7A, 0x00, 0x4A, 0x00, 0x70, 0x00,
            0x72, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x64, 0x00, 0x61, 0x00, 0x33, 0x00, 0x45, 0x00,
            0x6B, 0x00, 0x51, 0x00, 0x5A, 0x00, 0x36, 0x00, 0x67, 0x00, 0x4E, 0x00, 0x68, 0x00, 0x6D, 0x00, 0x54, 0x00,
            0x51, 0x00, 0x55, 0x00, 0x58, 0x00, 0x4B, 0x00, 0x50, 0x00, 0x41, 0x00, 0x6F, 0x00, 0x36, 0x00, 0x47, 0x00,
            0x57, 0x00, 0x4E, 0x00, 0x36, 0x00, 0x42, 0x00, 0x33, 0x00, 0x4A, 0x00, 0x42, 0x00, 0x61, 0x00, 0x64, 0x00,
            0x56, 0x00, 0x62, 0x00, 0x35, 0x00, 0x61, 0x00, 0x43, 0x00, 0x72, 0x00, 0x6A, 0x00, 0x47, 0x00, 0x77, 0x00,
            0x38, 0x00, 0x67, 0x00, 0x3D, 0x00, 0x3D, 0x00, 0x0D, 0x00, 0x0A, 0x00, 0x23, 0x00, 0x20, 0x00, 0x53, 0x00,
            0x49, 0x00, 0x47, 0x00, 0x20, 0x00, 0x23, 0x00, 0x20, 0x00, 0x45, 0x00, 0x6E, 0x00, 0x64, 0x00, 0x20, 0x00,
            0x73, 0x00, 0x69, 0x00, 0x67, 0x00, 0x6E, 0x00, 0x61, 0x00, 0x74, 0x00, 0x75, 0x00, 0x72, 0x00, 0x65, 0x00,
            0x20, 0x00, 0x62, 0x00, 0x6C, 0x00, 0x6F, 0x00, 0x63, 0x00, 0x6B, 0x00, 0x0D, 0x00, 0x0A, 0x00,
        ];

        let file_content = extract_signed_ps_file_content_bytes(&signed_utf16_file);

        assert_eq!(
            file_content,
            &[
                0xFF, 0xFE, 0x23, 0x00, 0x20, 0x00, 0x53, 0x00, 0x63, 0x00, 0x72, 0x00, 0x69, 0x00, 0x70, 0x00, 0x74,
                0x00, 0x20, 0x00, 0x6D, 0x00, 0x6F, 0x00, 0x64, 0x00, 0x75, 0x00, 0x6C, 0x00, 0x65, 0x00, 0x20, 0x00,
                0x6F, 0x00, 0x72, 0x00, 0x20, 0x00, 0x62, 0x00, 0x69, 0x00, 0x6E, 0x00, 0x61, 0x00, 0x72, 0x00, 0x79,
                0x00, 0x20, 0x00, 0x6D, 0x00, 0x6F, 0x00, 0x64, 0x00, 0x75, 0x00, 0x6C, 0x00, 0x65, 0x00, 0x0D, 0x00,
                0x0A, 0x00
            ]
        );
    }
}
