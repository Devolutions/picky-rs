using Xunit;

namespace Devolutions.Picky.Tests;

public class Pkcs7Tests
{

    private static readonly string p7bRepr = @"-----BEGIN PKCS7-----
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
zEFv26UMfItGCUWhADEA
-----END PKCS7-----
    ";

    [Fact]
    public void Parse()
    {
        Pem pem = Pem.Parse(p7bRepr);
        Pkcs7 pkcs7 = Pkcs7.FromPem(pem);

        Pem newPem = pkcs7.ToPem();

        Assert.Equal(pem.ToRepr(), newPem.ToRepr());
    }

}